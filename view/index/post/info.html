{extend name="public/base"}
{block name="title"}{$config['title']} - {$config['description']}{/block}
{block name="toptip"}主页{/block}
{block name="head"}
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/dropzone@5.7.1/dist/dropzone.min.css">
{/block}
{block name="toptip"}
<a href="{:url('/')}" title="返回首页"><i class="la la-arrow-left"></i></a>
<div>主题帖</div>
{/block}
{block name="body"}
<div id="feed_list">
    <div class="post card">
        <div class="card-body no-gutters">
            <div class="col mb-1">
                <div class="row no-gutters">
                    <img class="mr-2 rounded-circle" src="{$info.user.avatar_url}" width="48" height="48">
                    <div class="flex-grow-1">
                        <div class="font-weight-bold">{$info.user.nickname}</div>
                        <div class="stamp">{:app\\common\\controller\\Common::time_tran($info.create_time)}</div>
                    </div>
                </div>
            </div>
            <div class="col">
                {if !empty($info.text_format.text)}
                <p class="card-text">{$info.text_format.text|raw}</p>
                {/if}
                {if !empty($info.text_format.image)}
                <div class="post-image-row">
                    {volist name="info.text_format.image" id="url"}
                    <div class="post-image-col">
                        <img src="{$url}">
                    </div>
                    {/volist}
                </div>
                <div class="artZoomBox">
                    <div class="tool clearfix">
                        <a href="javascript:;" class="hideImg"><i class="la la-upload"></i>收起</a>
                        <a href="javascript:;" class="viewImg" target="_blank"><i class="la la-external-link-square-alt"></i>查看原图</a>
                        <a href="javascript:;" class="imgLeft"><i class="la la-undo-alt"></i>向左旋转</a>
                        <a href="javascript:;" class="imgRight"><i class="la la-redo-alt"></i>向右旋转</a>
                    </div>
                    <div class="maxImgRow"></div>
                </div>
                {/if}
            </div>
            <div class="handle row">
                <div class="col">
                    <i class="la la-eye"></i>{$info.view_num}
                </div>
                <div class="col relay">
                    <i class="la la-share"></i>{$info.relay_num}
                </div>
                <div class="col reply">
                    <i class="la la-comment"></i>{$info.reply_num}
                </div>
                <div class="col like">
                    <i class="la la-heart-o"></i>{$info.like_num}
                </div>
                <div class="col more">
                    <i class="la la-ellipsis-h"></i>
                </div>
                {if $info.uid==$user.uid}
                <!-- <div class="col">
                    删除
                </div> -->
                {/if}
            </div>
        </div>
    </div>
</div>
<div id="comments">
    <div class="respond">
        <div class="comments-title">发表评论</div>
        <form method="post" action="{:url('/post/comment',['id'=>$info.id])}" class="comment-form d-flex flex-column">
            <textarea rows="5" cols="50" name="text" class="comment-textarea" required></textarea>
            <div class="d-flex pt-2">
                <div class="flex-grow-1">
                    表情
                    图片
                    同时转发到我的微博
                </div>
                <button type="submit" class="btn btn-primary">评论</button>
            </div>
        </form>
    </div>
    <div class="comment-list">
<?php
function echocomments($comments)
{?>
        <div class="comment-body">
            <div class="d-flex">
                    <div class="d-flex flex-column">
                        <div class="a-avatar d-flex flex-column">
                            <img src="{$comments.user.avatar_url}" width="43" height="43">
                        </div>
                    </div>
                    <div class="author d-flex flex-column">
                        <div class="flex-grow-1">
                            <div class="comment-author">
                                <a href="#">{$comments.user.nickname}</a>
                            </div>
                            <div class="comment-time">{:app\\common\\controller\\Common::time_tran($comments.create_time)}</div>
                        </div>
                        <div class="comment-content">{$comments.text_format|raw}</div>
                    </div>
            </div>
<?php if (!empty($comments['child'])) {
    foreach ($comments['child'] as $vo) {
        echocomments($vo);
    }
}?>
        </div>
        <?php }?>
<?php
foreach ($comments as $vo) {
    echocomments($vo);
}?>
    </div>
    <div class="page-Link d-flex align-content-center">
        <ol class="page-navigator d-flex">
            <li class="current"><a href="">1</a></li>
            <li><a href="">2</a></li>
            <li><a href="">3</a></li>
            <li><span>...</span></li>
            <li><a href="">100</a></li>
            <li class="next"><a href="">»</a></li>
        </ol>
    </div>
</div>
{/block}
{block name="foot"}
<script src="__JS__/extends.js"></script>
<script>
picctrl();
</script>
{/block}